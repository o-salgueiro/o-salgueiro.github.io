const dict = {
  gl: {
    "site.title":"Club O Salgueiro – Tenis","site.brand":"Sociedad Deportiva O Salgueiro",
    "nav.tennis":"Tenis","nav.activities":"Actividades","nav.history":"Historia","nav.facilities":"Instalacións","nav.news":"Novas","nav.fees":"Tarifas","nav.contact":"Contacto",
    "hero.tag":"Tenis como actividade principal","hero.title":"O teu club de tenis na Coruña","hero.subtitle":"Benvidos á Sociedade Deportiva O'Salgueiro: club familiar para practicar tenis, pádel e natación nunha contorna natural única.","hero.cta.tennis":"Ver tenis","hero.cta.contact":"Contactar",
    "tennis.title":"Tenis","tennis.facilities.title":"Pistas e instalacións","tennis.facilities.text":"Pistas de tenis con iluminación e vestiarios. Entorno natural e tranquilo para xogar todo o ano.",
    "activities.title":"Outras actividades","activities.padel.title":"Pádel","activities.padel.text":"Pista de herba sintética con iluminación artificial","activities.pool.title":"Piscina","activities.pool.text":"Piscina ao aire libre en ampla zona verde para a tempada de verán.","activities.social.title":"Actividades sociais","activities.social.text":"Ligas internas de tenis, encontros familiares e eventos do clube.",
    "history.title":"A nosa historia","history.lead1":"A nosa historia",
    "history.p1":"A orixe da Sociedade Deportiva O'Salgueiro remóntase a 1975, cando un grupo de apaixonados polo tenis decidiu mercar uns terreos para construír a pista de tenis. Case todos eles seguen hoxe practicando este deporte e continúan como socios do Club.",
    "history.p2":"Aquela pista inicial, co paso dos anos, foi evolucionando ata o actual conxunto de instalacións que enriquecen os servizos que a Sociedade Deportiva presta aos seus socios.",
    "history.p3":"O'Salgueiro mantivo ao longo destes anos unha grande presenza no mundo da competición do tenis galego.",
    "history.p4":"Entre os seus socios atópanse, desde hai anos e na actualidade, campións de Galicia, campións de España e campións de Europa en diversas categorías de veteranos, tanto en individuais como en dobres.",
    "fac.title":"Instalacións","fac.p1":"Tres pistas de tenis quick, dúas delas con iluminación artificial.","fac.p2":"Pista de pádel de herba sintética con iluminación artificial.","fac.p3":"Campo de fútbol 7 de herba natural.","fac.p4":"Magnífica piscina de 12 x 6 m. dotada das últimas tecnoloxías e con solario de herba natural.","fac.p5":"Pérgola con capacidade para 25 persoas e tres grellas á disposición dos socios.","fac.p6":"Sala de tecnificación.",
    "fac.techroom":"Sala de tecnificación.","fac.gym":"Ximnasio.","fac.sauna":"Sauna.","fac.lockers":"Vestiarios femininos e masculinos.","fac.lounge":"Salón de TV e xogos de mesa.","fac.pingpong":"Tenis de mesa.","fac.billiards":"Mesa de billar francés.",
    "news.title":"Novas",
    "fees.title":"Tarifas","fees.membership.title":"Cota familiar de socio/a","fees.membership.text":"","fees.note":"",
    "contact.title":"Contacto","contact.name":"Nome","contact.message":"Mensaxe","contact.send":"Enviar","contact.where":"Onde estamos","contact.map":"Ver en Google Maps","contact.extra":"A 4 km de Betanzos · Horario 24 horas",
    "contact.privacy.accept":"ACEPTO A POLÍTICA DE PRIVACIDADE PARA O TRATAMENTO DOS DADOS PERSONAIS DE ACORDO COA LOPD-DGG 3/2018 E RGPD 679/2016.",
    "cookie.title":"Uso de cookies","cookie.text":"Usamos cookies propias e de terceiros para mellorar a experiencia do sitio web. Debe aceptar o uso de cookies para continuar navegando.","cookie.accept":"Aceptar","cookie.more":"Máis información",
    "mailto.prompt":"Semella que non hai un cliente de correo predeterminado para \"mailto:\". Quiere abrir Gmail para enviar a mensaxe?",
    "footer.about.title":"Sobre o clube","footer.about.text":"A Sociedade Deportiva O'Salgueiro é un club familiar con instalacións para tenis, pádel e natación, nunha paisaxe de beleza singular e en plena natureza.","footer.links.title":"Ligazóns","footer.legal.title":"Legal","footer.legal.legal":"Aviso Legal","footer.legal.privacy":"Política de Privacidade","footer.legal.cookies":"Política de Cookies",
    "club.title":"Sociedade Deportiva O'Salgueiro","club.p1":"A Sociedade Deportiva O'Salgueiro é un club deportivo de carácter familiar con estupendas instalacións para a práctica do tenis, pádel e natación, actividades que poden realizar persoas de todas as idades e é unha maneira de facer deporte e tamén divertirse.","club.p2":"Sitúase nunha paisaxe de beleza singular e con integración en plena natureza, o que fai que a práctica de deporte sexa máis placenteira.","club.p3":"Vén e coñece o Club da Sociedade Deportiva O'Salgueiro, onde poderás gozar do teu deporte favorito.",
    "sponsor.title":"Patrocinios","sponsor.dep.title":"Deputación da Coruña","sponsor.dep.call":"Convocatoria FO104/2025","sponsor.dep.object":"Obxecto: Renovación do firme da pista 2","sponsor.dep.amount":"Importe concedido: 12.500,00€"
  },
  es: {
    "site.title":"Club O Salgueiro – Tenis","site.brand":"Sociedad Deportiva O Salgueiro",
    "nav.tennis":"Tenis","nav.activities":"Actividades","nav.history":"Historia","nav.facilities":"Instalaciones","nav.news":"Noticias","nav.fees":"Tarifas","nav.contact":"Contacto",
    "hero.tag":"Tenis como actividad principal","hero.title":"Tu club de tenis en A Coruña","hero.subtitle":"Bienvenidos a la Sociedad Deportiva O'Salgueiro: club familiar para practicar tenis, pádel y natación en un entorno natural único.","hero.cta.tennis":"Ver tenis","hero.cta.contact":"Contactar",
    "tennis.title":"Tenis","tennis.facilities.title":"Pistas e instalaciones","tennis.facilities.text":"Pistas de tenis con iluminación y vestuarios. Entorno natural y tranquilo para jugar todo el año.",
    "activities.title":"Otras actividades","activities.padel.title":"Pádel","activities.padel.text":"Pista de hierba sintética con iluminación artificial","activities.pool.title":"Piscina","activities.pool.text":"Piscina al aire libre en amplia zona verde para la temporada de verano.","activities.social.title":"Actividades sociales","activities.social.text":"Ligas internas de tenis, encuentros familiares y eventos del club.",
    "history.title":"Nuestra historia","history.lead1":"Nuestra historia",
    "history.p1":"El origen de la Sociedad Deportiva O'Salgueiro se remonta a 1975, cuando unos apasionados por el tenis se lanzaron a comprar unos terrenos para construir la pista de tenis. Casi todos ellos continúan a día de hoy practicando este deporte y siguen siendo socios del Club.",
    "history.p2":"Aquella cancha del principio, con el paso de los años, fue evolucionando al actual conjunto de instalaciones que enriquecen los servicios que presta la Sociedad Deportiva a sus socios.",
    "history.p3":"O'Salgueiro ha mantenido a lo largo de estos años una gran presencia en el mundo de la competición del tenis gallego.",
    "history.p4":"Entre sus socios se encuentran, desde hace años y en la actualidad, campeones de Galicia, campeones de España y campeones de Europa en diversas categorías de veteranos, tanto en la modalidad de individuales como de dobles.",
    "fac.title":"Instalaciones","fac.p1":"Tres pistas de tenis quick, dos de ellas con iluminación artificial.","fac.p2":"Pista de pádel de hierba sintética con iluminación artificial.","fac.p3":"Campo de fútbol 7 de hierba natural.","fac.p4":"Magnífica piscina de 12 x 6 m dotada de las últimas tecnologías y con solárium de herba natural.","fac.p5":"Pérgola con capacidad para 25 personas y tres parrillas a disposición de los socios.","fac.p6":"Sala de tecnificación.",
    "fac.techroom":"Sala de tecnificación.","fac.gym":"Gimnasio.","fac.sauna":"Sauna.","fac.lockers":"Vestuarios femeninos y masculinos.","fac.lounge":"Salón de TV y juegos de mesa.","fac.pingpong":"Tenis de mesa.","fac.billiards":"Mesa de billar francés.",
    "news.title":"Noticias",
    "fees.title":"Tarifas","fees.membership.title":"Cuota familiar de socio","fees.membership.text":"","fees.note":"",
    "contact.title":"Contacto","contact.name":"Nombre","contact.message":"Mensaje","contact.send":"Enviar","contact.where":"Dónde estamos","contact.map":"Ver en Google Maps","contact.extra":"A 4 km de Betanzos · Horario 24 horas",
    "contact.privacy.accept":"ACEPTO LA POLÍTICA DE PRIVACIDAD PARA EL TRATAMIENTO DE LOS DATOS PERSONALES DE ACUERDO CON LA LOPD-DGG 3/2018 y RGPD 679/2016.",
    "cookie.title":"Uso de cookies","cookie.text":"Utilizamos cookies propias y de terceros para mejorar la experiencia del sitio web. Para continuar navegando debe aceptar el uso de cookies.","cookie.accept":"Aceptar","cookie.more":"Más información",
    "mailto.prompt":"Parece que no hay una aplicación de correo predeterminada para \"mailto:\". ¿Quieres abrir Gmail para enviar el mensaje?",
    "footer.about.title":"Sobre el club","footer.about.text":"La Sociedad Deportiva O'Salgueiro es un club familiar con instalaciones para tenis, pádel y natación, en un paisaje de gran belleza y plena naturaleza.","footer.links.title":"Enlaces","footer.legal.title":"Legal","footer.legal.legal":"Aviso Legal","footer.legal.privacy":"Política de Privacidad","footer.legal.cookies":"Política de Cookies",
    "club.title":"Sociedad Deportiva O'Salgueiro","club.p1":"La Sociedad Deportiva O'Salgueiro es un club deportivo de carácter familiar con estupendas instalaciones para la práctica del tenis, pádel y natación, actividades que pueden realizar personas de todas las edades y que son una manera de hacer deporte y también divertirse.","club.p2":"Se sitúa en un paisaje de gran belleza e integrada en plena naturaleza, lo que hace que la práctica del deporte sea más placentera.","club.p3":"Ven y conoce el Club de la Sociedad Deportiva O'Salgueiro, donde podrás disfrutar de tu deporte favorito.",
    "sponsor.title":"Patrocinios","sponsor.dep.title":"Deputación da Coruña","sponsor.dep.call":"Convocatoria FO104/2025","sponsor.dep.object":"Objeto: Renovación del firme de la pista 2","sponsor.dep.amount":"Importe concedido: 12.500,00€"
  },
  en: {
    "site.title":"Club O Salgueiro – Tennis","site.brand":"Sociedad Deportiva O Salgueiro",
    "nav.tennis":"Tennis","nav.activities":"Activities","nav.history":"History","nav.facilities":"Facilities","nav.news":"News","nav.fees":"Fees","nav.contact":"Contact",
    "hero.tag":"Tennis as our main activity","hero.title":"Your tennis club in A Coruña","hero.subtitle":"Welcome to Sociedad Deportiva O'Salgueiro: a family-friendly club for tennis, padel and swimming in a unique natural setting.","hero.cta.tennis":"See tennis","hero.cta.contact":"Contact",
    "tennis.title":"Tennis","tennis.facilities.title":"Courts & facilities","tennis.facilities.text":"Tennis courts with lighting and locker rooms. Quiet natural setting to play all year round.",
    "activities.title":"Other activities","activities.padel.title":"Padel","activities.padel.text":"Synthetic-grass court with floodlights","activities.pool.title":"Pool","activities.pool.text":"Outdoor pool in a large green area for the summer season.","activities.social.title":"Social events","activities.social.text":"Internal tennis leagues, family gatherings and club events.",
    "history.title":"Our history","history.lead1":"Our history",
    "history.p1":"The origins of Sociedad Deportiva O'Salgueiro date back to 1975, when a group of tennis enthusiasts purchased land to build the tennis court. Most of them still play today and remain members of the Club.",
    "history.p2":"That initial court, over the years, evolved into the current set of facilities that enhance the services offered by the Club to its members.",
    "history.p3":"Over the years, O'Salgueiro has maintained a strong presence in Galician competitive tennis.",
    "history.p4":"Among its members, both in the past and today, there are champions of Galicia, Spain and Europe in various veterans' categories, in both singles and doubles.",
    "fac.title":"Facilities","fac.p1":"Three quick tennis courts, two with floodlights.","fac.p2":"Synthetic-grass padel court with floodlights.","fac.p3":"7-a-side football pitch with natural grass.","fac.p4":"Superb 12×6 m pool with the latest technology and a natural-grass solarium.","fac.p5":"Pergola for 25 people and three barbecues for members to use.","fac.p6":"High-performance training room.",
    "fac.techroom":"High-performance training room.","fac.gym":"Gym.","fac.sauna":"Sauna.","fac.lockers":"Women's and men's locker rooms.","fac.lounge":"TV lounge and board games.","fac.pingpong":"Table tennis.","fac.billiards":"French billiards table.",
    "news.title":"News",
    "fees.title":"Fees","fees.membership.title":"Family membership","fees.membership.text":"","fees.note":"",
    "contact.title":"Contact","contact.name":"Name","contact.message":"Message","contact.send":"Send","contact.where":"Where we are","contact.map":"View on Google Maps","contact.extra":"4 km from Betanzos · Open 24h",
    "contact.privacy.accept":"I ACCEPT THE PRIVACY POLICY FOR THE PROCESSING OF PERSONAL DATA IN ACCORDANCE WITH LOPD-DGG 3/2018 AND GDPR 679/2016.",
    "cookie.title":"Cookie usage","cookie.text":"We use our and third-party cookies to improve the site experience. You must accept cookies to keep browsing.","cookie.accept":"Accept","cookie.more":"More info",
    "mailto.prompt":"It seems there is no default mail app for \"mailto:\". Do you want to open Gmail to send the message?",
    "footer.about.title":"About the club","footer.about.text":"Sociedad Deportiva O'Salgueiro is a family-friendly club with tennis, padel and swimming facilities, set in beautiful natural surroundings.","footer.links.title":"Links","footer.legal.title":"Legal","footer.legal.legal":"Legal Notice","footer.legal.privacy":"Privacy Policy","footer.legal.cookies":"Cookie Policy",
    "club.title":"Sociedad Deportiva O'Salgueiro","club.p1":"Sociedad Deportiva O'Salgueiro is a family-friendly sports club with excellent facilities for tennis, padel and swimming — activities for all ages and a way to keep fit while having fun.","club.p2":"It is set in beautiful surroundings and fully integrated with nature, making sports practice even more enjoyable.","club.p3":"Come and discover the Sociedad Deportiva O'Salgueiro Club, where you can enjoy your favourite sport.",
    "sponsor.title":"Sponsorship","sponsor.dep.title":"Deputación da Coruña","sponsor.dep.call":"Call FO104/2025","sponsor.dep.object":"Object: Renewal of court 2 surface","sponsor.dep.amount":"Amount awarded: 12,500.00€"
  }
};

function applyLang(lang){
  const strings = dict[lang] || dict.es;
  document.documentElement.lang = lang;
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (strings[key]) el.textContent = strings[key];
  });
  document.title = strings['site.title'] || document.title;
  document.querySelectorAll('.lang button').forEach(btn => {
    const active = btn.getAttribute('data-lang') === lang;
    btn.classList.toggle('active', active);
    btn.setAttribute('aria-pressed', active ? 'true' : 'false');
  });
  try { localStorage.setItem('lang', lang); } catch(e){}
}

function initLang(){
  const stored = localStorage.getItem('lang');
  const lang = (stored && ['gl','es','en'].includes(stored)) ? stored : 'es';
  applyLang(lang);
}

document.addEventListener('DOMContentLoaded', ()=>{
  initLang();
  document.querySelectorAll('.lang button').forEach(btn => {
    btn.addEventListener('click', ()=>applyLang(btn.getAttribute('data-lang')));
  });

  const sections=['inicio','tenis','actividades','historia','instalacions','novas','tarifas','contacto'];
  function showSection(id){
    try{ localStorage.setItem('last_tab', id); }catch(e){}
    const all = sections.map(s=>document.getElementById(s)).filter(Boolean);
    all.forEach(el=>el.classList.add('hidden'));
    if(id==='inicio' || !sections.includes(id)){
      document.getElementById('inicio').classList.remove('hidden');
    }else{
      const target=document.getElementById(id); if(target) target.classList.remove('hidden');
    }
    document.querySelectorAll('nav a[href^="#"]').forEach(a=>{
      const ok=a.getAttribute('href')==='#'+id;
      a.classList.toggle('active',ok);
      a.setAttribute('aria-current', ok ? 'page' : 'false');
    });
    window.scrollTo({top:0,behavior:'instant'});
  }
  const initial = (location.hash.replace('#','')) || 'inicio';
  showSection(initial);
  window.addEventListener('hashchange', ()=>showSection(location.hash.replace('#','')||'inicio'));

  // Hero carousel 5s
  const imgs = Array.from(document.querySelectorAll('#hero-carousel img'));
  let i=0;
  if (imgs.length){
    imgs.forEach((im, idx)=> im.classList.toggle('active', idx===0));
    setInterval(()=>{
      imgs[i].classList.remove('active');
      i = (i + 1) % imgs.length;
      imgs[i].classList.add('active');
    }, 5000);
  }

  // Lightbox
  const lb=document.getElementById('lightbox');
  const lbImg=lb ? lb.querySelector('img') : null;
  const closeBtn=lb ? lb.querySelector('.lightbox-close') : null;
  function openLB(src){ if(lbImg){ lbImg.src=src; } if(lb) lb.classList.add('show'); }
  function closeLB(){ if(lb) lb.classList.remove('show'); if(lbImg) lbImg.removeAttribute('src'); }
  function bindGallery(id){
    const g=document.getElementById(id);
    if(g) g.addEventListener('click',e=>{ if(e.target && e.target.tagName==='IMG') openLB(e.target.src); });
  }
  bindGallery('gallery'); bindGallery('gallery-instalacions');
  if(lb) lb.addEventListener('click',e=>{ if(e.target===lb) closeLB(); });
  if(closeBtn) closeBtn.addEventListener('click', closeLB);
  document.addEventListener('keydown',e=>{ if(e.key==='Escape') closeLB(); });

  // COOKIE CONSENT: bloqueo ligero hasta aceptar
  const COOKIE_KEY = 'os_cookie_consent';
  const cookieEl = document.getElementById('cookie-consent');
  const cookieAcceptBtn = document.getElementById('cookie-accept');

  function showCookie(){ if(cookieEl) cookieEl.classList.remove('hidden'); document.body.setAttribute('data-cookie','required'); }
  function hideCookie(){ if(cookieEl) cookieEl.classList.add('hidden'); document.body.removeAttribute('data-cookie'); }

  try{
    const stored = localStorage.getItem(COOKIE_KEY);
    if(stored === 'accepted'){
      hideCookie();
    }else{
      showCookie();
    }
  }catch(e){ showCookie(); }

  if(cookieAcceptBtn){
    cookieAcceptBtn.addEventListener('click', () => {
      try{ localStorage.setItem(COOKIE_KEY,'accepted'); }catch(e){}
      hideCookie();
    });
  }

  // Evitar navegación hasta aceptar cookies (salvo enlaces a la página de cookies)
  document.addEventListener('click', (e)=>{
    const a = e.target.closest && e.target.closest('a');
    if(!a) return;
    const href = a.getAttribute('href') || '';
    if(href.includes('cookies') || href.includes('/cookies.html') || href.includes('cookies.html')) return;
    if(localStorage.getItem(COOKIE_KEY) !== 'accepted'){
      e.preventDefault();
      if(cookieEl) cookieEl.classList.remove('hidden');
      window.scrollTo({top:document.body.scrollHeight, behavior:'smooth'});
    }
  }, true);

  // Mailto + validación checkbox privacidad + cookies
  window.sendMailto = function(e){
    e.preventDefault();
    const name=document.getElementById('cf-name') ? document.getElementById('cf-name').value.trim() : '';
    const email=document.getElementById('cf-email') ? document.getElementById('cf-email').value.trim() : '';
    const msg=document.getElementById('cf-message') ? document.getElementById('cf-message').value.trim() : '';
    const privacyChecked = document.getElementById('cf-privacy') ? document.getElementById('cf-privacy').checked : false;

    if(!name || !email || !msg){
      alert((document.documentElement.lang || 'es') === 'en' ? 'Please complete all required fields.' : (document.documentElement.lang || 'es') === 'gl' ? 'Completa todos os campos obrigatorios.' : 'Por favor completa todos los campos obligatorios.');
      return false;
    }

    if(!privacyChecked){
      alert((document.documentElement.lang || 'es') === 'en' ? 'You must accept the privacy policy to send.' : (document.documentElement.lang || 'es') === 'gl' ? 'Debe aceptar a política de privacidade para enviar.' : 'Debe aceptar la política de privacidad para enviar.');
      return false;
    }

    if(localStorage.getItem(COOKIE_KEY) !== 'accepted'){
      if(cookieEl) cookieEl.classList.remove('hidden');
      alert((document.documentElement.lang || 'es') === 'en' ? 'You must accept cookies before continuing.' : (document.documentElement.lang || 'es') === 'gl' ? 'Debe aceptar as cookies antes de continuar.' : 'Debe aceptar las cookies antes de continuar.');
      return false;
    }

    const subject=encodeURIComponent(`Contacto web – ${name}`);
    const body=encodeURIComponent(`Nome: ${name}\nEmail: ${email}\n\nMensaxe:\n${msg}`);
    const mail=`mailto:salgueiropaderne@gmail.com?subject=${subject}&body=${body}`;
    const a=document.getElementById('mailto-hidden');
    if(a){ a.setAttribute('href', mail); a.click(); }

    try{ window.location.assign(mail); }catch(_){}

    setTimeout(()=>{
      if (!document.hasFocus()) return;
      const lang=(document.documentElement.lang||'es');
      const strings=dict[lang]||dict.es;
      const promptTxt=strings['mailto.prompt'] || dict.es['mailto.prompt'];
      if(confirm(promptTxt)){
        const url=`https://mail.google.com/mail/?view=cm&fs=1&to=salgueiropaderne@gmail.com&su=${subject}&body=${body}`;
        window.open(url, '_blank', 'noopener');
      }
    }, 300);

    return false;
  };

  // set year
  const y=document.getElementById('year'); if(y) y.textContent = new Date().getFullYear();
});